<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GrassCare - Anasayfa</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

  <!-- React + ReactDOM + Babel -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Supabase UMD -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script>
    const supabaseUrl = 'https://puurwgrzknxttjsjxdit.supabase.co';
    const supabaseKey = 'BURAYA_PUBLIC_ANON_KEY_GELECEK';
    window.supabase = supabase.createClient(supabaseUrl, supabaseKey); /* [web:123][web:250] */
  </script>

  <!-- Header -->
  <script type="text/babel" src="./components/public-header.js?v=3"></script>
</head>

<body class="bg-slate-900 text-slate-100">
  <div id="root"></div>

  <script type="text/babel">
    const { createRoot } = ReactDOM;

    const LoginForm = () => {
      const [email, setEmail] = React.useState("");
      const [password, setPassword] = React.useState("");
      const [loading, setLoading] = React.useState(false);
      const [errorMsg, setErrorMsg] = React.useState("");

      const handleLogin = async (e) => {
        e.preventDefault();
        setLoading(true);
        setErrorMsg("");

        const { data, error } = await supabase.auth.signInWithPassword({
          email,
          password,
        }); /* email/şifre login [web:242][web:235] */

        setLoading(false);

        if (error) {
          setErrorMsg("Giriş başarısız, lütfen email ve şifreni kontrol et.");
          return;
        }

        window.location.href = "hesabim.html";
      };

      return (
        <form onSubmit={handleLogin} className="space-y-4">
          <input
            type="email"
            placeholder="E-posta"
            className="w-full rounded-lg border border-slate-600 bg-slate-800 px-3 py-2"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            required
          />
          <input
            type="password"
            placeholder="Şifre"
            className="w-full rounded-lg border border-slate-600 bg-slate-800 px-3 py-2"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            required
          />
          {errorMsg && <p className="text-sm text-red-400">{errorMsg}</p>}
          <button
            type="submit"
            disabled={loading}
            className="w-full px-4 py-2 bg-teal-500 hover:bg-teal-600 text-white font-medium rounded-xl transition-all"
          >
            {loading ? "Giriş yapılıyor..." : "Giriş Yap"}
          </button>
        </form>
      );
    };

    const HomePage = () => {
      return (
        <div className="min-h-screen flex flex-col">
          <window.Header />

          <main className="flex-1">
            <section className="max-w-6xl mx-auto px-4 py-10 md:px-8 lg:px-12">
              <h1 className="text-3xl md:text-4xl font-black mb-4">
                Akıllı Sulama Asistanınız GrassCare
              </h1>
              <p className="text-slate-300 max-w-xl mb-10">
                Bahçenizi, sitenizi veya tarlanızı akıllı sensörler ve otomatik programlarla yönetin.
              </p>

              <div id="giris" className="mt-10 max-w-md">
                <h2 className="text-xl font-semibold mb-4">Giriş Yap</h2>
                <LoginForm />
                <p className="mt-4 text-sm text-slate-400">
                  Henüz hesabın yok mu?{" "}
                  <a href="uyelik.html" className="text-teal-400 underline">
                    Üyelik oluştur
                  </a>
                </p>
              </div>
            </section>
          </main>
        </div>
      );
    };

    const root = createRoot(document.getElementById("root"));
    root.render(<HomePage />);
  </script>
</body>
</html>
