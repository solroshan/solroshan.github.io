<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="/assets/css/images/leaf.png" rel="shortcut icon" type="image/png" />
  <title>GrassCare</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

  <!-- React + ReactDOM + Babel -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Supabase UMD -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script>
    const supabaseUrl = 'https://puurwgrzknxttjsjxdit.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB1dXJ3Z3J6a254dHRqc2p4ZGl0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0NTIyODUsImV4cCI6MjA4MTAyODI4NX0.tYoFbwWeuPCAXLXVp8yX0ThbvWPgboYOCUqPuKtAoaI';
    window.supabase = supabase.createClient(supabaseUrl, supabaseKey); /* client [web:123] */
  </script>

  <!-- Public header + footer -->
  <script type="text/babel" src="./components/public-header.js"></script>
  <script type="text/babel" src="./components/Footer.js"></script>
</head>

<body class="bg-slate-900 font-sans text-slate-100">
  <div id="root"></div>

  <script type="text/babel">
    const { createRoot } = ReactDOM;

    const HomePage = () => {
      const [displayName, setDisplayName] = React.useState(null);

      React.useEffect(() => {
        const checkUserAndProfile = async () => {
          const { data, error } = await supabase.auth.getUser(); // [web:123]
          if (error || !data?.user) {
            setDisplayName(null);
            return;
          }

          const u = data.user;
          const meta = u.user_metadata || {};
          const firstName = meta.first_name?.trim();
          const lastName = meta.last_name?.trim();
          const phone = meta.phone?.trim();
          const email = u.email?.trim();

          // Profil eksikse hesabım sayfasına yönlendir
          if (!firstName || !lastName || !phone || !email) {
            window.location.href = "hesabim.html";
            return;
          }

          setDisplayName(`${firstName} ${lastName}`.trim());
        };

        checkUserAndProfile();
      }, []);

      return (
        <div className="min-h-screen flex flex-col">
          <window.Header />

          <main className="flex-1">
            <section className="max-w-6xl mx-auto px-4 py-10 md:px-8 lg:px-12">
              {displayName && (
                <p className="mb-4 text-sm text-slate-300">
                  Hoş geldin,{" "}
                  <span className="font-semibold text-teal-300">
                    {displayName}
                  </span>
                </p>
              )}

              {/* Buraya mevcut anasayfa hero ve diğer içeriklerin geliyor */}
              <h1 className="text-3xl md:text-4xl font-black mb-4">
                Akıllı Sulama Asistanınız GrassCare
              </h1>
              <p className="text-slate-300 max-w-xl">
                Bahçenizi, sitenizi veya tarlanızı akıllı sensörler ve otomatik programlarla
                yönetin.
              </p>

              {/* Örnek giriş alanı anchor için */}
              <div id="giris" className="mt-10">
                {/* Buraya giriş / kayıt formu ya da butonların olduğu blok geliyor */}
              </div>
            </section>
          </main>

          <window.Footer />
        </div>
      );
    };

    const root = createRoot(document.getElementById("root"));
    root.render(<HomePage />);
  </script>
</body>
</html>
